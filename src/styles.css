@import "tailwindcss";

/* Markdown Table Styling (Tailwind @apply) */
.markdown-body table {
  @apply w-full border-collapse my-4 text-[0.95em];
}
.markdown-body th,
.markdown-body td {
  @apply border border-neutral-300 dark:border-neutral-700 px-3 py-2 text-left;
}
.markdown-body th {
  @apply bg-neutral-100 dark:bg-neutral-800 font-semibold dark:text-neutral-200;
}
.markdown-body tr {
  @apply dark:text-neutral-300;
}
.markdown-body tr:nth-child(even) {
  @apply bg-neutral-50 dark:bg-neutral-850;
}

/* Custom variants */
@custom-variant dark (&:where(.dark, .dark *));
@custom-variant interactive (&:where(.interactive, .interactive *));
@custom-variant toggle (&:where(.toggle, .toggle *));
@custom-variant square (&:where(.square, .square *));
@custom-variant circular (&:where(.circular, .circular *));

/* Tailwind config */
@theme {
  /* Type */
  --text-xs: 10px;
  --text-xs--line-height: calc(1 / 0.5);

  --text-sm: 12px;
  --text-sm--line-height: calc(1 / 0.75);

  --text-base: 14px;
  --text-base--line-height: calc(1.25 / 0.875);

  /* Easings & transitions */
  --ease-bounce: cubic-bezier(0.2, 0, 0, 1.5);
  --default-transition-duration: 100ms /* snappier than default 150ms */;

  /* Animation */
  --animate-refresh: refresh 0.5s ease-in-out infinite;

  /* Base colors */
  --color-black: #000;
  --color-white: #fff;

  --color-neutral-50: oklch(0.985 0 0);
  --color-neutral-100: oklch(0.97 0 0);
  --color-neutral-150: oklch(0.96 0 0) /*new */;
  --color-neutral-200: oklch(0.922 0 0);
  --color-neutral-250: oklch(0.9 0 0) /* new */;
  --color-neutral-300: oklch(0.87 0 0);
  --color-neutral-400: oklch(0.708 0 0);
  --color-neutral-450: oklch(0.62 0 0) /* new */;
  --color-neutral-500: oklch(0.556 0 0);
  --color-neutral-600: oklch(0.439 0 0);
  --color-neutral-700: oklch(0.371 0 0);
  --color-neutral-750: oklch(0.31 0 0) /* new */;
  --color-neutral-800: oklch(0.269 0 0);
  --color-neutral-850: oklch(0.23 0 0) /* new */;
  --color-neutral-900: oklch(0.205 0 0);
  --color-neutral-925: oklch(0.175 0 0) /* new */;
  --color-neutral-950: oklch(0.145 0 0);

  --color-red-650: oklch(0.55 0.238 27.4);
  --color-red-750: oklch(0.46 0.195 27.2);

  --color-blue-400: oklch(0.707 0.165 254.624);
  --color-blue-800: oklch(0.424 0.199 265.638);

  /* Component colors */

  /* Base colors */
  --color-ob-base-100: var(--color-white);
  --color-ob-base-200: var(--color-neutral-50);
  --color-ob-base-300: var(--color-neutral-100);
  --color-ob-base-400: var(--color-neutral-200);
  --color-ob-base-500: var(--color-neutral-300);
  --color-ob-base-1000: var(--color-neutral-900);

  --color-ob-border: var(--color-neutral-200);
  --color-ob-border-active: var(--color-neutral-400);

  /* Text colors */
  --text-color-ob-base-100: var(--color-neutral-500);
  --text-color-ob-base-200: var(--color-neutral-600);
  --text-color-ob-base-300: var(--color-neutral-900);
  --text-color-ob-destructive: var(--color-red-600);
  --text-color-ob-inverted: var(--color-white);

  /* ob-btn */
  --color-ob-btn-primary-bg: var(--color-neutral-750);
  --color-ob-btn-primary-bg-hover: var(--color-neutral-850);
  --color-ob-btn-primary-border: var(--color-neutral-500);
  --color-ob-btn-primary-border-hover: var(--color-neutral-600);

  --color-ob-btn-secondary-bg: var(--color-white);
  --color-ob-btn-secondary-bg-hover: var(--color-neutral-50);
  --color-ob-btn-secondary-border: var(--color-neutral-200);
  --color-ob-btn-secondary-border-hover: var(--color-neutral-300);

  --color-ob-btn-ghost-bg-hover: var(--color-neutral-150);

  --color-ob-btn-destructive-bg: var(--color-red-600);
  --color-ob-btn-destructive-bg-hover: var(--color-red-650);
  --color-ob-btn-destructive-border: var(--color-red-400);
  --color-ob-btn-destructive-border-hover: var(--color-red-500);

  /* Focus colors */
  --color-ob-focus: var(--color-blue-400);
}

.dark {
  /* Component colors */

  /* Base colors */
  --color-ob-base-100: var(--color-neutral-950);
  --color-ob-base-200: var(--color-neutral-900);
  --color-ob-base-300: var(--color-neutral-850);
  --color-ob-base-400: var(--color-neutral-800);
  --color-ob-base-500: var(--color-neutral-750);
  --color-ob-base-1000: var(--color-neutral-50);

  --color-ob-border: var(--color-neutral-800);
  --color-ob-border-active: var(--color-neutral-700);

  /* Text colors */
  --text-color-ob-base-100: var(--color-neutral-500);
  --text-color-ob-base-200: var(--color-neutral-400);
  --text-color-ob-base-300: var(--color-neutral-50);
  --text-color-ob-destructive: var(--color-red-400);
  --text-color-ob-inverted: var(--color-neutral-900);

  /* ob-btn */
  --color-ob-btn-primary-bg: var(--color-neutral-300);
  --color-ob-btn-primary-bg-hover: var(--color-neutral-250);
  --color-ob-btn-primary-border: var(--color-neutral-100);
  --color-ob-btn-primary-border-hover: var(--color-white);

  --color-ob-btn-secondary-bg: var(--color-neutral-900);
  --color-ob-btn-secondary-bg-hover: var(--color-neutral-850);
  --color-ob-btn-secondary-border: var(--color-neutral-800);
  --color-ob-btn-secondary-border-hover: var(--color-neutral-750);

  --color-ob-btn-ghost-bg-hover: var(--color-neutral-850);

  --color-ob-btn-destructive-bg: var(--color-red-800);
  --color-ob-btn-destructive-bg-hover: var(--color-red-750);
  --color-ob-btn-destructive-border: var(--color-red-700);
  --color-ob-btn-destructive-border-hover: var(--color-red-600);

  /* Focus colors */
  --color-ob-focus: var(--color-blue-800);
}

.btn {
  &.btn-primary {
    @apply border-ob-btn-primary-border bg-ob-btn-primary-bg text-ob-inverted shadow-xs;

    @variant interactive {
      @apply not-disabled:hover:border-ob-btn-primary-border-hover not-disabled:hover:bg-ob-btn-primary-bg-hover;

      @variant toggle {
        @apply not-disabled:border-ob-btn-primary-border-hover not-disabled:bg-ob-btn-primary-bg-hover;
      }
    }
  }

  &.btn-secondary {
    @apply border-ob-btn-secondary-border bg-ob-btn-secondary-bg text-ob-base-300 shadow-xs;

    @variant interactive {
      @apply not-disabled:hover:border-ob-btn-secondary-border-hover not-disabled:hover:bg-ob-btn-secondary-bg-hover;

      @variant toggle {
        @apply not-disabled:border-ob-btn-secondary-border-hover not-disabled:bg-ob-btn-secondary-bg-hover;
      }
    }
  }

  &.btn-ghost {
    @apply text-ob-base-300 border-transparent bg-transparent;

    @variant interactive {
      @apply not-disabled:hover:bg-ob-btn-ghost-bg-hover;

      @variant toggle {
        @apply not-disabled:bg-ob-btn-ghost-bg-hover;
      }
    }
  }

  &.btn-destructive {
    @apply border-ob-btn-destructive-border bg-ob-btn-destructive-bg text-white;

    @variant interactive {
      @apply not-disabled:hover:bg-ob-btn-destructive-bg-hover not-disabled:hover:border-ob-btn-destructive-border-hover;

      @variant toggle {
        @apply not-disabled:bg-ob-btn-destructive-bg-hover not-disabled:border-ob-btn-destructive-border-hover;
      }
    }
  }

  @apply border;

  @variant interactive {
    @apply cursor-pointer transition-colors;
  }
}

/* Use for elements that require a tab-focus state (most elements) */
.add-focus {
  @apply focus-visible:ring-ob-focus outline-none focus:opacity-100 focus-visible:ring-1 *:in-focus:opacity-100;
}

/* Use for elements that require a disabled state */
.add-disable {
  @apply disabled:text-ob-base-100 disabled:cursor-not-allowed;
}

/* Use size variants for elements that need to match certain heights */
.add-size-sm {
  @apply h-6.5 rounded px-2 text-sm;

  @variant square {
    @apply flex size-6.5 items-center justify-center px-0;
  }

  @variant circular {
    @apply flex size-6.5 items-center justify-center rounded-full px-0;
  }
}

.add-size-md {
  @apply h-8 rounded-md px-2.5 text-base;

  @variant square {
    @apply flex size-8 items-center justify-center px-0;
  }

  @variant circular {
    @apply flex size-8 items-center justify-center rounded-full px-0;
  }
}

.add-size-base {
  @apply h-9 rounded-md px-3 text-base;

  @variant square {
    @apply flex size-9 items-center justify-center px-0;
  }

  @variant circular {
    @apply flex size-9 items-center justify-center rounded-full px-0;
  }
}

/* Database card animation */
.db-card {
  animation: db-card-animation 3s linear infinite;
  animation-play-state: paused; /* pause while group is not hovered */
  stroke-dasharray: 100; /* length of each dash */

  &:is(:where(.group):hover *) {
    @media (hover: hover) {
      animation-play-state: running; /* play while group is hovered */
    }
  }
}

@keyframes db-card-animation {
  0% {
    stroke-dashoffset: -200;
  }
  50% {
    stroke-dashoffset: 0;
  }
  100% {
    stroke-dashoffset: 200;
  }
}

/* SVG filters */
.pixelate {
  filter: url(#pixelate);
}

/* Ripple filter */
.ripple {
  filter: url(#ripple);
}

.float {
  animation: float 5s linear infinite alternate;
}

@keyframes float {
  to {
    transform: translate(5px, 15px);
  }
}

@keyframes refresh {
  to {
    transform: rotate(360deg) scale(0.9);
  }
}

/* Starry night theme */
.starry-sky {
  background: radial-gradient(
    circle at 10% 10%,
    #1f3a70 0%,
    #0b1220 50%,
    #030612 100%
  );
  color: var(--color-white);
  position: relative;
  overflow: hidden;
}

/* ensure main content sits above decorative layers */
.star-content {
  position: relative;
  z-index: 2;
}

.starry-sky .stars {
  position: absolute;
  inset: 0;
  background-image:
    radial-gradient(
      1px 1px at 10% 20%,
      rgba(255, 255, 255, 0.9) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 20% 40%,
      rgba(255, 255, 255, 0.85) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 30% 15%,
      rgba(255, 255, 255, 0.7) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 40% 60%,
      rgba(255, 255, 255, 0.6) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 55% 30%,
      rgba(255, 255, 255, 0.9) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 65% 80%,
      rgba(255, 255, 255, 0.8) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 75% 50%,
      rgba(255, 255, 255, 0.75) 50%,
      transparent 51%
    ),
    radial-gradient(
      1px 1px at 85% 25%,
      rgba(255, 255, 255, 0.9) 50%,
      transparent 51%
    );
  background-repeat: repeat;
  background-size: 200px 200px;
  animation: twinkle 6s linear infinite;
  opacity: 0.95;
  pointer-events: none;
}

@keyframes twinkle {
  0%,
  100% {
    opacity: 0.9;
    transform: translateY(0);
  }
  50% {
    opacity: 1;
    transform: translateY(-2px);
  }
}

.starry-sky .moon {
  position: absolute;
  right: 8%;
  top: 6%;
  width: 120px;
  height: 120px;
  border-radius: 50%;
  background: radial-gradient(
    circle at 35% 30%,
    #fff 0%,
    #f6f7e9 18%,
    #e6e8d4 35%,
    rgba(230, 232, 212, 0) 60%
  );
  box-shadow:
    0 0 40px rgba(255, 240, 200, 0.18),
    inset -8px -6px 18px rgba(200, 200, 200, 0.12);
  filter: drop-shadow(0 6px 18px rgba(0, 0, 0, 0.4));
  pointer-events: none;
}

.starry-sky .constellation {
  position: absolute;
  left: 6%;
  top: 12%;
  width: 280px;
  height: 160px;
  opacity: 0.8;
  pointer-events: none;
}

.starry-sky .streetwalk {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 160px;
  background: linear-gradient(
    180deg,
    rgba(3, 6, 12, 0) 0%,
    rgba(2, 6, 12, 0.6) 40%,
    rgba(2, 6, 12, 1) 100%
  );
  pointer-events: none;
}

.street-silhouette {
  position: absolute;
  left: 10%;
  bottom: 18px;
  width: 80%;
  height: 120px;
  background: linear-gradient(
    90deg,
    rgba(0, 0, 0, 0.85),
    rgba(10, 10, 10, 0.95)
  );
  clip-path: polygon(
    0 60%,
    6% 60%,
    6% 54%,
    12% 54%,
    12% 60%,
    100% 60%,
    100% 100%,
    0% 100%
  );
}

.bench {
  position: absolute;
  left: 18%;
  bottom: 30px;
  width: 120px;
  height: 34px;
  background: linear-gradient(180deg, #0b0b0b, #141414);
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.6);
}
.bench::before {
  content: "";
  position: absolute;
  left: 6px;
  bottom: -18px;
  width: 12px;
  height: 36px;
  background: #0b0b0b;
}

.lamp {
  /* shooting star */
  .shooting-star {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background: linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.98),
      rgba(255, 220, 180, 0.9)
    );
    box-shadow:
      0 0 8px rgba(255, 240, 200, 0.9),
      0 0 20px rgba(255, 200, 120, 0.5);
    transform: translate3d(0, 0, 0) rotate(-25deg);
    pointer-events: none;
    will-change: transform, opacity;
    animation: shoot 900ms ease-out forwards;
  }

  @keyframes shoot {
    0% {
      opacity: 1;
      transform: translate3d(0, 0, 0) scale(1);
    }
    70% {
      opacity: 0.95;
    }
    100% {
      opacity: 0;
      transform: translate3d(800px, -300px, 0) scale(0.6);
    }
  }

  /* small stars individual twinkle override */
  .stars .small-star {
    position: absolute;
    width: 2px;
    height: 2px;
    border-radius: 50%;
    background: white;
    opacity: 0.9;
    filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.9));
    will-change: opacity, transform;
    animation: star-twinkle 3s infinite ease-in-out;
  }

  @keyframes star-twinkle {
    0% {
      opacity: 0.6;
      transform: scale(0.9);
    }
    50% {
      opacity: 1;
      transform: scale(1.15);
    }
    100% {
      opacity: 0.6;
      transform: scale(0.9);
    }
  }
  position: absolute;
  right: 18%;
  bottom: 40px;
  width: 6px;
  height: 120px;
  background: linear-gradient(180deg, #0b0b0b, #111111);
}
.lamp::after {
  content: "";
  position: absolute;
  left: -28px;
  top: -40px;
  width: 80px;
  height: 80px;
  background: radial-gradient(
    circle at 30% 30%,
    rgba(255, 240, 200, 0.12) 0%,
    rgba(255, 240, 200, 0.06) 30%,
    rgba(255, 240, 200, 0) 60%
  );
  border-radius: 50%;
  filter: blur(6px);
}

/* small subtle glow for streetlight */
.lamp .glow {
  position: absolute;
  left: -22px;
  top: -32px;
  width: 44px;
  height: 44px;
  border-radius: 50%;
  background: radial-gradient(
    circle at 30% 30%,
    rgba(255, 230, 160, 0.9),
    rgba(255, 200, 100, 0.18) 35%,
    rgba(255, 200, 100, 0.02) 60%
  );
  filter: blur(4px);
}

/* Inline SVG street layout styles: keep SVG positioned like the previous divs */
.streetwalk .street-svg {
  position: absolute;
  left: 10%;
  bottom: 0px;
  width: 80%;
  height: 160px;
  pointer-events: none;
  overflow: visible;
}

/* Make sure SVG groups use visible fills that match previous look */
.streetwalk .street-svg .street-silhouette {
  /* silhouette uses the gradient defined inside the SVG; ensure it sits above background */
  mix-blend-mode: normal;
}

.streetwalk .street-svg .bench rect {
  fill: #0b0b0b;
}
.streetwalk .street-svg .bench rect:nth-child(3) {
  fill: #141414;
}

.streetwalk .street-svg .lamp .glow {
  opacity: 0.95;
  filter: blur(6px);
}
